From 100ed29395c78a3d3181d94bd74c5d2425c8a537 Mon Sep 17 00:00:00 2001
From: Ashley Wulber <ashley@system76.com>
Date: Fri, 24 Oct 2025 09:21:05 -0400
Subject: [PATCH] chore: update libcosmic

---
 Cargo.lock        | 93 ++++++++++-------------------------------------
 src/access.rs     | 11 +++---
 src/screenshot.rs |  2 +-
 3 files changed, 27 insertions(+), 79 deletions(-)

diff --git a/Cargo.lock b/Cargo.lock
index a40575a..48c766c 100644
--- a/Cargo.lock
+++ b/Cargo.lock
@@ -1484,7 +1484,7 @@ dependencies = [
 [[package]]
 name = "cosmic-config"
 version = "0.1.0"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "atomicwrites",
  "cosmic-config-derive",
@@ -1505,7 +1505,7 @@ dependencies = [
 [[package]]
 name = "cosmic-config-derive"
 version = "0.1.0"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "quote",
  "syn 2.0.106",
@@ -1617,7 +1617,7 @@ dependencies = [
 [[package]]
 name = "cosmic-settings-daemon"
 version = "0.1.0"
-source = "git+https://github.com/pop-os/dbus-settings-bindings#37cbe4e8c165428178be23a14bd37f19a19d3757"
+source = "git+https://github.com/pop-os/dbus-settings-bindings#b2337437d70b3db7a56211a43aa1632306711b2d"
 dependencies = [
  "zbus 5.11.0",
 ]
@@ -1625,7 +1625,7 @@ dependencies = [
 [[package]]
 name = "cosmic-text"
 version = "0.14.2"
-source = "git+https://github.com/pop-os/cosmic-text.git#d409ddd1d32c222f3c0b8c06a286172b157613f3"
+source = "git+https://github.com/pop-os/cosmic-text.git#cffdea2b334e7830a5fd6f95bf5e1784014442a8"
 dependencies = [
  "bitflags 2.9.4",
  "fontdb 0.23.0",
@@ -1648,7 +1648,7 @@ dependencies = [
 [[package]]
 name = "cosmic-theme"
 version = "0.1.0"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "almost",
  "cosmic-config",
@@ -3271,7 +3271,7 @@ dependencies = [
  "js-sys",
  "log",
  "wasm-bindgen",
- "windows-core 0.62.2",
+ "windows-core 0.56.0",
 ]
 
 [[package]]
@@ -3286,7 +3286,7 @@ dependencies = [
 [[package]]
 name = "iced"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "dnd",
  "iced_accessibility",
@@ -3304,7 +3304,7 @@ dependencies = [
 [[package]]
 name = "iced_accessibility"
 version = "0.1.0"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "accesskit",
  "accesskit_winit",
@@ -3313,7 +3313,7 @@ dependencies = [
 [[package]]
 name = "iced_core"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "bitflags 2.9.4",
  "bytes",
@@ -3337,7 +3337,7 @@ dependencies = [
 [[package]]
 name = "iced_futures"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "futures",
  "iced_core",
@@ -3363,7 +3363,7 @@ dependencies = [
 [[package]]
 name = "iced_graphics"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "bitflags 2.9.4",
  "bytemuck",
@@ -3385,7 +3385,7 @@ dependencies = [
 [[package]]
 name = "iced_renderer"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "iced_graphics",
  "iced_tiny_skia",
@@ -3397,7 +3397,7 @@ dependencies = [
 [[package]]
 name = "iced_runtime"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "bytes",
  "cosmic-client-toolkit",
@@ -3412,7 +3412,7 @@ dependencies = [
 [[package]]
 name = "iced_tiny_skia"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "bytemuck",
  "cosmic-text",
@@ -3428,7 +3428,7 @@ dependencies = [
 [[package]]
 name = "iced_wgpu"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "as-raw-xcb-connection",
  "bitflags 2.9.4",
@@ -3459,7 +3459,7 @@ dependencies = [
 [[package]]
 name = "iced_widget"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "cosmic-client-toolkit",
  "dnd",
@@ -3478,7 +3478,7 @@ dependencies = [
 [[package]]
 name = "iced_winit"
 version = "0.14.0-dev"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "cosmic-client-toolkit",
  "dnd",
@@ -4561,7 +4561,7 @@ checksum = "2874a2af47a2325c2001a6e6fad9b16a53b802102b528163885171cf92b15976"
 [[package]]
 name = "libcosmic"
 version = "0.1.0"
-source = "git+https://github.com/pop-os/libcosmic#f44d82a7e83af15270a9ca3beb832f4799699337"
+source = "git+https://github.com/pop-os/libcosmic#6204784f202c19b675c5a0c8a56865e3f1d9bd69"
 dependencies = [
  "apply",
  "ashpd 0.12.0",
@@ -8272,7 +8272,7 @@ version = "0.54.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "12661b9c89351d684a50a8a643ce5f608e20243b9fb84687800163429f161d65"
 dependencies = [
- "windows-result 0.1.2",
+ "windows-result",
  "windows-targets 0.52.6",
 ]
 
@@ -8284,23 +8284,10 @@ checksum = "4698e52ed2d08f8658ab0c39512a7c00ee5fe2688c65f8c0a4f06750d729f2a6"
 dependencies = [
  "windows-implement 0.56.0",
  "windows-interface 0.56.0",
- "windows-result 0.1.2",
+ "windows-result",
  "windows-targets 0.52.6",
 ]
 
-[[package]]
-name = "windows-core"
-version = "0.62.2"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "b8e83a14d34d0623b51dce9581199302a221863196a1dde71a7663a4c2be9deb"
-dependencies = [
- "windows-implement 0.60.2",
- "windows-interface 0.59.3",
- "windows-link",
- "windows-result 0.4.1",
- "windows-strings",
-]
-
 [[package]]
 name = "windows-implement"
 version = "0.53.0"
@@ -8323,17 +8310,6 @@ dependencies = [
  "syn 2.0.106",
 ]
 
-[[package]]
-name = "windows-implement"
-version = "0.60.2"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "053e2e040ab57b9dc951b72c264860db7eb3b0200ba345b4e4c3b14f67855ddf"
-dependencies = [
- "proc-macro2",
- "quote",
- "syn 2.0.106",
-]
-
 [[package]]
 name = "windows-interface"
 version = "0.53.0"
@@ -8356,17 +8332,6 @@ dependencies = [
  "syn 2.0.106",
 ]
 
-[[package]]
-name = "windows-interface"
-version = "0.59.3"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "3f316c4a2570ba26bbec722032c4099d8c8bc095efccdc15688708623367e358"
-dependencies = [
- "proc-macro2",
- "quote",
- "syn 2.0.106",
-]
-
 [[package]]
 name = "windows-link"
 version = "0.2.1"
@@ -8382,24 +8347,6 @@ dependencies = [
  "windows-targets 0.52.6",
 ]
 
-[[package]]
-name = "windows-result"
-version = "0.4.1"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "7781fa89eaf60850ac3d2da7af8e5242a5ea78d1a11c49bf2910bb5a73853eb5"
-dependencies = [
- "windows-link",
-]
-
-[[package]]
-name = "windows-strings"
-version = "0.5.1"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "7837d08f69c77cf6b07689544538e017c1bfcf57e34b4c0ff58e6c2cd3b37091"
-dependencies = [
- "windows-link",
-]
-
 [[package]]
 name = "windows-sys"
 version = "0.45.0"
diff --git a/src/access.rs b/src/access.rs
index 668341d..d33ef9c 100644
--- a/src/access.rs
+++ b/src/access.rs
@@ -151,7 +151,7 @@ impl AccessDialogArgs {
                 layer: cosmic_client_toolkit::sctk::shell::wlr_layer::Layer::Top,
                 keyboard_interactivity:
                     cosmic_client_toolkit::sctk::shell::wlr_layer::KeyboardInteractivity::OnDemand,
-                pointer_interactivity: true,
+                input_zone: None,
                 anchor: cosmic_client_toolkit::sctk::shell::wlr_layer::Anchor::empty(),
                 output: IcedOutput::Active,
                 namespace: "access portal".to_string(),
@@ -269,10 +269,11 @@ pub fn update_msg(portal: &mut CosmicPortal, msg: Msg) -> cosmic::Task<crate::ap
         Msg::Choice(i, j) => {
             let args = portal.access_args.as_mut().unwrap();
             if let Some(choice) = args.options.choices.as_ref().and_then(|x| x.get(i))
-                && let Some((option_id, _)) = choice.2.get(j) {
-                    args.active_choices
-                        .insert(choice.0.clone(), option_id.clone());
-                }
+                && let Some((option_id, _)) = choice.2.get(j)
+            {
+                args.active_choices
+                    .insert(choice.0.clone(), option_id.clone());
+            }
             cosmic::iced::Task::none()
         }
         Msg::Ignore => cosmic::iced::Task::none(),
diff --git a/src/screenshot.rs b/src/screenshot.rs
index 732c244..9bfb345 100644
--- a/src/screenshot.rs
+++ b/src/screenshot.rs
@@ -885,7 +885,7 @@ pub fn update_args(portal: &mut CosmicPortal, args: Args) -> cosmic::Task<crate:
                         id: *id,
                         layer: Layer::Overlay,
                         keyboard_interactivity: KeyboardInteractivity::Exclusive,
-                        pointer_interactivity: true,
+                        input_zone: None,
                         anchor: Anchor::all(),
                         output: IcedOutput::Output(output.clone()),
                         namespace: "screenshot".to_string(),
